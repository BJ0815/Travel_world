class SchedulesController < ApplicationController
<<<<<<< HEAD
#  before_action :authenticate_suspend
=======
  before_action :authenticate_user!
  before_action :authenticate_suspend
  before_action :set_schedule, only: [:review, :show,:get_new_details]
  before_action :set_detail, only: [:review, :show]
>>>>>>> modify/redesignSpotNewFlow
  #排定行程method
  def review
    @event = Event.find(params[:event_id])
    @categories = Category.all
  end

  def show
    @details = @schedule.details
    render :layout => false
  end

<<<<<<< HEAD

  #搜尋行程default
  #根據前面輸入的國家和地點自動帶入
  def search
    #puts params[:event_id]
    event = Event.find(params[:event_id])
    space =" "
    destination = event.district
    puts destination
    @client = GooglePlaces::Client.new(GoogleKey)
    @spots= @client.spots_by_query(destination,{ language: I18n.locale})
    @categories = Category.all
=======
  def get_new_details
    #@schedule= Schedule.find(params[:id])
    @spots = @schedule.spots
    render :json => { :spots => @spots }
>>>>>>> modify/redesignSpotNewFlow
  end

  def get_distance
    #@schedule = Schedule.find(params[:id])
    @from =@schedule.spots.first
    @to = @schedule.spots.last
    origin = GoogleDistanceMatrix::Place.new lat: @from.lat, lng: @from.lng
    destination = GoogleDistanceMatrix::Place.new lat: @to.lat, lng: @to.lng



@matrix = GoogleDistanceMatrix::Matrix.new(
  origins: [origin],
  destinations: [destination],
  language: I18n.locale
)
@matrix.configure do |config|
  #config.sensor = true
  config.mode = "transit"
  transit_mode = "bus"
   config.google_api_key = GoogleKey
end
  #render :json => { :matrix => matrix }
  #render :layout => false
  end

  private
  def set_schedule
    @schedule = Schedule.find(params[:id])
  end

  def set_detail
    @details = @schedule.details
  end


end
